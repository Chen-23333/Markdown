# 正则表达式

## 前言

内容整体偏短，适合于新手想要快速掌握正则表达式中的语法知识，以及复习、回顾时查阅，遇到暂不熟悉的字符，推荐继续向后阅读，或结合百度使用。

## 简介

简单来说，正则表达式是一种用来匹配和处理文本的字符串。例如用来匹配文本中是否包含特定的字符串，校验文本是否满足特定的条件，按条件批量替换文本信息，获取特定的分组结果，等等。

正则表达式使用正则表达式语言来构建，有自己独特的语法。不过正则表达式语言并非是一种程序设计语言，从个人角度来看，类似于数学表达式。例如当我们给定 $f(x)=x^2$ 时，我们会明确知道这个表达式的运算规则，那么当我们给定 `[0-9]` 时，我们也会同样明确清楚这个正则表达式的匹配规则（表示匹配一个数字）。同时，正则表达式也像数学表达式一样，支持任意规则的随意组合。

目前，在绝大多数的语言以及计算相关的平台中，均支持正则表达式，当处理较为复杂的字符串相关的逻辑时，我们应当首先考虑使用正则表达式来辅助我们实现需求。

## 普通字符

普通字符包含了所有未被指定为元字符（后文会介绍）的字符，例如数字 `0-9`，字母 `a-z` 与 `A-Z`，当然也可以通过 Unicode 用于匹配汉字，例如 `[\u4e00-\u9fa5]` 包含了约 2w 个汉字，基本覆盖了所有常用的简体与繁体字符。此外，普通字符也包含了非打印字符，例如常见的换行符 `\n`，制表符 `\t` 等等。

当我们在使用普通字符构造正则表达式时，看上去就像是纯文本，但他的确是正则表达式的一种。例如：

| 文本 | 正则表达式 | 匹配结果 |
| ---- | ---- | ---- |
| 红色可表示为 #FF0000 | `#FF0000` | 红色可表示为 **#FF0000** |
| 绿色可表示为 #00FF00 | `绿色` | **绿色**可表示为 #FF0000 |

## 元字符

元字符是指在正则表达式中具有特殊含义的字符，代表了正则表达式中的特殊语法，而非其字面意思。通过这些元字符，我们可以大大拓展正则表达式的匹配规则，而非上文中仅匹配纯文本信息。常见的元字符如 `*` 匹配任意数量的元素， `{n}` 匹配 n 次，`[xyz]` 匹配一组元素中任意一个。

当我们将元字符与普通字符结合时，就可以构造出我们想要的任何字符串的正则表达式了。同样以上面的例子为例，此处我们将匹配任意的符合 RBG 规范的字符串，以及匹配所有满足需求的颜色：

| 文本 | 正则表达式 | 匹配结果 |
| ---- | ---- | ---- |
| 红色可表示为 #FF0000 | `#[0-9a-fA-F]{6}` | 红色可表示为 **#FF0000** |
| 绿色可表示为 #00FF00 | `[红橙黄绿青蓝紫]色` | **绿色**可表示为 #FF0000 |

- `#[0-9a-fA-F]{6}` 表示匹配一个 `#` 开头，后面紧跟着六位合法的 16 进制字符的字符串，其中 `[0-9a-fA-F]` 表示匹配 (0123456789AaBbCcDdEeFf) 中的任意一个，`{6}` 则表示重复 6 次。
- `[红橙黄绿青蓝紫]色` 表示匹配彩虹色中的任意一种，即红色、橙色、黄色、绿色、青色、蓝色、紫色中的任意一种。

### 转义

如前文所提到的，元字符在正则表达式中，会有着特殊含义，例如 `*` 可用来匹配任意个字符，所以这些字符在正则表达式中无法匹配他们自身。例如 `0*`，会被用来匹配任意个连续的 `0`，而非字符 `0*` 本身。

通过元字符 `\`，我们可以改变紧随其后的字符的含义。对于表达式 `\*`，可以将 `*` 从元字符变为普通字符，进而就可以用来匹配 `*` 字符本身了。例如：

| 文本 | 正则表达式 | 匹配结果 |
| ---- | ---- | ---- |
| 000000* | `0*` | **000000**\* |
| 000000* | `0\*` | 00000**0\*** |

当然，`\` 本身也是元字符的一种，想要匹配 `\` 本身，同样需要进行转义，即使用 `\\` 来匹配。

除了将一个特殊字符标记为普通字符以外，转义也会用于将普通字符标记为特殊字符，如换行符 `\n`，制表符 `\t` 等等。

### 字符集合

在某些场景下，我们要匹配的目标可能是一系列值中的某一个，而非是某个特定的字符串，此时我们可以使用字符集合来表示匹配集合中的任意一个字符，字符集合使用 `[xyz]` 来表示，其中 `[` 与 `]` 仅用来定义一个集合，不会匹配任何字符，`xyz` 代表将匹配 `x`、`y` 与 `z` 三个字符中的任意一个。例如：

| 文本 | 正则表达式 | 匹配结果 |
| ---- | ---- | ---- |
| Monday | `[mMnN]` | **M**o**n**day |
| Monday | `[mn]` | Mo**n**day |

#### 字符区间

在某些常见下，我们所选用的字符集合，会具备明显特征，如数字集合 `[0123456789]`、小写字母集合 `[abc...xyz]`、大写字母集合 `[ABC...XYZ]` 等等。为了简化这种有明显规律性的集合定义，正则表达式提供了一个特殊的连字符 `-` 来简化定义。上述所提到的集合，可简化为 `[0-9]`、`[a-z]` 与 `[A-Z]`。

对于熟悉 ASCII 与 Unicode 的同学可以发现，上面所提到的 `0-9` 、`a-z` 与 `A-Z` 均符合 Unicode 中的编码顺序，而这也正是连字符所发挥的作用，用于匹配两个指定的 Unicode 字符之间的所有字符（闭区间）。所以当我们想要匹配所有字母时，必须指定为 `[a-zA-Z]`，而不能指定为 `[A-z]`，因为这会包括 `Z` 与 `a` 之间的某些字符，如 `[` 和 `^` 等。同样，我们还可以利用这一特性，去匹配某一特定的字符集合，如 `[\u4e00-\u9fa5]` 用于匹配常见汉字，`[\u0370-\u03FF]` 用于匹配所有小写希腊字母。

| 文本 | 正则表达式 | 匹配结果 |
| ---- | ---- | ---- |
| 0123456789 | `[024]` | **0**1**2**3**4**56789 |
| 0123456789 | `[5-9]` | 01234**56789** |

#### 取反



## 附录

### 非打印字符

| 字符 | 描述 |
| ---- | ---- |
| \\cx | 匹配由x指明的控制字符。例如， \\cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。 |
| \\f | 匹配一个换页符。等价于 \\x0c 和 \\cL。 |
| \\n | 匹配一个换行符。等价于 \\x0a 和 \\cJ。 |
| \\r | 匹配一个回车符。等价于 \\x0d 和 \\cM。 |
| \\s | 匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \\f\\n\\r\\t\\v]。 |
| \\S | 匹配任何非空白字符。等价于 [^ \\f\\n\\r\\t\\v]。 |
| \\t | 匹配一个制表符。等价于 \\x09 和 \\cI。 |
| \\v | 匹配一个垂直制表符。等价于 \\x0b 和 \\cK。 |

### 元字符

| 字符 | 描述 |
| --- | --- |
| \\ | 将下一个字符标记为一个特殊字符、或一个原义字符、或一个向后引用、或一个八进制转义符。 |
| ^ | 匹配输入字符串的开始位置。 |
| $ | 匹配输入字符串的结束位置。 |
| * | 匹配前面的子表达式零次或多次。 |
| + | 匹配前面的子表达式一次或多次。 |
| ? | 匹配前面的子表达式零次或一次。 |
| {n} | n 是一个非负整数。匹配确定的 n 次。 |
| {n,} | n 是一个非负整数。至少匹配n 次。 |
| {n,m} | m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。 |
| ? (后缀) | 当该字符紧跟在任何一个其他限制符 (*, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的。 |
| . | 匹配除 "\n" 之外的任何单个字符。 |
| (pattern) | 匹配 pattern 并获取这一匹配。 |
| (?:pattern) | 匹配 pattern 但不获取匹配结果，也就是说这是一个非获取匹配，不进行存储供以后使用。 |
| (?=pattern) | 正向预查，在任何匹配 pattern 的字符串开始处匹配查找字符串。 |
| (?!pattern) | 负向预查，在任何不匹配 pattern 的字符串开始处匹配查找字符串。 |
| x&#124;y | 匹配 x 或 y。 |
| [xyz] | 字符集合。匹配所包含的任意一个字符。 |
| [^xyz] | 负值字符集合。匹配未包含的任意字符。 |
| [a-z] | 字符范围。匹配指定范围内的任意字符。 |
| [^a-z] | 负值字符范围。匹配任何不在指定范围内的任意字符。 |
| \b | 匹配一个单词边界，也就是指单词和空格间的位置。 |
| \B | 匹配非单词边界。 |
| \cx | 匹配由 x 指明的控制字符。 |
| \d | 匹配一个数字字符。 |
| \D | 匹配一个非数字字符。 |
| \f | 匹配一个换页符。 |
| \n | 匹配一个换行符。 |
| \r | 匹配一个回车符。 |
| \s | 匹配任何空白字符，包括空格、制表符、换页符等等。|
| \S | 匹配任何非空白字符。 |
| \t | 匹配一个制表符。 |
| \v | 匹配一个垂直制表符。 |
| \w | 匹配包括下划线的任何单词字符。 |
| \W | 匹配任何非单词字符。 |
| \xn | 匹配 n，其中 n 为十六进制转义值。 |
| \num | 匹配 num，其中 num 是一个正整数。对所获取的匹配的引用。 |
| \n | 标识一个八进制转义值或一个向后引用。 |
| \nm | 标识一个八进制转义值或一个向后引用。 |
| \nml | 如果 n 为八进制数字 (0-3)，且 m 和 l 均为八进制数字 (0-7)，则匹配八进制转义值 nml。 |
| \un | 匹配 n，其中 n 是一个用四个十六进制数字表示的 Unicode 字符。 |
